<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE extension SYSTEM "ext-1.0.dtd">

<!--
/**
 * @copyright topic_title_on_index Copyright (C) 2008 hcs
 * @copyright Copyright (C) 2008 PunBB, partially based on code copyright (C) 2008 FluxBB.org
 * @license http://www.gnu.org/licenses/gpl.html GPL version 2 or higher
 * @package topic_title_on_index
 */
-->

<extension engine="1.0">
	<id>topic_title_on_index</id>
	<title>Topic title on forum index </title>
	<version>1.0.0 Beta</version>
	<description>Replace the Last Post link on the index page for the name of the topic instead of the date format.</description>
	<author>hcs</author>

	<minversion>1.3</minversion>
	<maxtestedon>1.3.2</maxtestedon>

	<hooks>
		<hook id="in_qr_get_cats_and_forums"><![CDATA[
$query['SELECT'] .=', t.subject';
$query['JOINS'][] = array(
    'LEFT JOIN'    => 'topics AS t',
    'ON'        => 'f.last_post_id=t.last_post_id'
);
		]]></hook>

		<hook id="in_normal_row_pre_display"><![CDATA[
$forum_page['item_body']['info']['lastpost'] = str_replace(array(format_time($cur_forum['last_post']), '<cite>'),array(forum_htmlencode($cur_forum['subject']), '<cite>'.format_time($cur_forum['last_post']).'</cite><cite>'),
$forum_page['item_body']['info']['lastpost']);
		]]></hook>

	</hooks>

</extension>
